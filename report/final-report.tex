\documentclass[a4paper,12pt]{report}
\usepackage[utf8]{inputenc} % To use Unicode (e.g. Turkish) characters
\renewcommand{\labelenumi}{(\roman{enumi})}
\usepackage{amsmath, amsthm, amssymb}
 % Some extra symbols
\usepackage[bottom]{footmisc}
\usepackage{cite}
\usepackage{url}
\usepackage{graphicx}
\usepackage{longtable}
\graphicspath{{figures/}} % Graphics will be here

\usepackage{multirow}
\usepackage{subfigure}
\usepackage{algorithm}
\usepackage{algorithmic}

\begin{document}

% Title Page
\title{CMPE 492 \\ Analysis of Market Dynamics of Crypto Exchanges: \\ A Comparative Study of CEX and DEX Markets}
\author{
Yusuf Akin \\
Halil Utku \c{C}elik \\
Cenk Yilmaz \\
\textbf{Advisor}: Can \"Ozturan
}
\date{January 2026}
\maketitle{}
\pagenumbering{roman}
\tableofcontents

\chapter{INTRODUCTION}
\pagenumbering{arabic}

\section{Background and Motivation}

Centralized exchanges (CEXs) and decentralized exchanges (DEXs) represent two fundamentally different market structures for cryptocurrency trading. CEXs such as Binance, Coinbase and OKX rely on high-throughput off-chain matching engines and orderbook-based price discovery, offering low-latency execution and deep liquidity. In contrast, DEXs such as Uniswap execute trades on-chain through automated market makers (AMMs), enabling self-custody and transparency at the cost of higher latency and execution frictions driven by pool depth, blockchain congestion and Maximal Extractable Value (MEV).

These structural differences create measurable gaps in execution quality and information flow between venues. For liquid pairs, CEXs often dominate price discovery due to their substantially larger trading volume, while DEX prices typically track and converge through arbitrage. For less liquid regimes or during volatile periods, deviations can persist longer, slippage grows nonlinearly with trade size, and on-chain transaction ordering can introduce additional costs beyond theoretical AMM price impact.

This project builds an end-to-end monitoring and analysis system to quantify these dynamics using real-time data streams from both CEX and DEX venues.

\subsection{CEX Orderbook Mechanics}
Most major CEX spot markets use a central limit order book (CLOB). Participants submit \textit{limit orders} (resting bids/asks at specified prices) and \textit{market orders} (immediate execution against the best available opposite-side liquidity). The matching engine typically enforces \textbf{price--time priority}: better prices match first; for equal prices, earlier orders match first. The resulting best bid/ask defines the spread, and the mid-price (average of best bid and best ask) provides a simple reference for fair price estimation.

Orderbook \textbf{market depth} (available quantity at/near the current price) largely determines execution quality: deeper books and tighter spreads yield lower slippage for a given trade size. In practice, this depth is sustained by a combination of professional market makers and broad participation, supported by low-latency infrastructure and high-throughput market data distribution~\cite{hasbrouck2007empirical,binance2024api}.

\subsection{MEV and Transaction Ordering Effects}
DEX trades are executed via blockchain transactions, which introduces an additional layer of execution cost not present in off-chain CEX matching: \textbf{transaction ordering}. On chains with a public mempool, pending swaps can be observed before inclusion in a block. Specialized actors (MEV ``searchers'') may reorder, insert, or bundle transactions to extract profit, for example through front-running/back-running and sandwich attacks~\cite{wu2025cex}.

For AMM-based DEXs, this matters because the swap price is a deterministic function of pool state and trade size. If an attacker trades just before a victim swap (moving the pool price) and then trades back after, the victim experiences worse execution than predicted by the AMM price impact alone. Empirically, this appears as additional slippage and heavier tails in execution-cost distributions, especially around volatile periods or large trades. In our system, we treat these effects as part of the observed execution outcome and discuss how they can widen CEX--DEX deviations and distort measured slippage beyond theoretical curves.

\subsection{On-Chain Orderbooks: Hyperliquid}
While many DEXs rely on AMMs, some modern systems implement \textbf{on-chain orderbooks} to approximate CEX-style trading while retaining on-chain settlement. Hyperliquid is a prominent example: it provides rapid block times (sub-second) and integrates order matching into the chain's execution/consensus pipeline, enabling limit-order trading with low user friction~\cite{hyperliquid2024docs,yan2024hyperliquid}.

This design changes the microstructure of decentralized trading. Compared with AMMs, execution quality depends more directly on orderbook depth rather than pool liquidity, and the system can reduce some forms of mempool-based MEV by altering transaction exposure and matching semantics. We include Hyperliquid as context for the broader design space of DEX market structures and to motivate why comparing ``DEX'' venues requires distinguishing AMM-based exchanges from orderbook-based decentralized trading systems.

\section{Problem Statement and Objectives}

The primary objective is to measure and explain cross-venue market dynamics between CEX and DEX markets for major cryptocurrency pairs. Specifically, we aim to:
\begin{itemize}
    \item compute a robust CEX reference price using a multi-exchange price index,
    \item capture DEX swap executions on Uniswap V2 and Uniswap V3 across Ethereum and BSC,
    \item quantify price deviation between DEX execution prices and the CEX reference price,
    \item measure lead--lag relationships to study price discovery and information flow,
    \item characterize slippage as a function of trade size using both theoretical and empirical approaches.
\end{itemize}

Our analysis focuses on the pairs BTC/USDT, ETH/USDT and BNB/USDT, using CEX feeds from Coinbase, MEXC, Binance, Gate.io, OKX, Bybit, HTX and KuCoin.

\section{Contributions}

This work makes the following contributions:
\begin{itemize}
    \item \textbf{Real-time multi-venue data collection:} A pipeline that streams ticker data from multiple CEX WebSocket APIs and swap events from Uniswap V2/V3 pools on Ethereum and BSC.
    \item \textbf{CEX price index:} A volume-weighted reference price constructed from multiple exchanges to reduce single-venue noise and anomalies.
    \item \textbf{Deviation and lead--lag analysis:} Metrics and analysis modules to quantify CEX--DEX deviation distributions and temporal relationships between venues.
    \item \textbf{Slippage characterization:} A framework combining theoretical AMM price impact with empirical slippage distributions derived from observed trades.
    \item \textbf{Storage and reporting:} A database-backed design supporting both real-time monitoring and retrospective statistical analysis.
\end{itemize}

\section{Broad Impact}

This project provides a structured empirical framework for comparing orderbook-based and AMM-based markets using consistent metrics. The results are relevant to researchers studying market microstructure, practitioners designing execution strategies, and liquidity providers evaluating the trade-offs between fee revenue and adverse execution costs. By quantifying deviation dynamics and lead--lag effects, the system supports evidence-based reasoning about where price discovery occurs and how quickly on-chain markets converge to off-chain reference prices.

\section{Ethical Considerations}

Measuring CEX--DEX deviations may highlight temporary inefficiencies that can be exploited via arbitrage. We treat this as ethically acceptable within the context of research transparency: such inefficiencies exist in public markets and are discoverable by capable participants. Moreover, arbitrage activity generally improves price alignment across venues, benefiting market participants through tighter effective spreads and better execution quality over time. We avoid providing prescriptive guidance for exploitation and instead focus on documenting aggregate dynamics and structural causes, including the role of MEV and transaction ordering on on-chain execution costs.

\chapter{PROJECT DEFINITION AND PLANNING}
\section{Project Definition}
\textbf{Research objectives.} The project conducts a comparative analysis of cryptocurrency market microstructure across centralized and decentralized venues. Our core research dimensions are:
\begin{itemize}
    \item \textbf{Price discovery dynamics:} quantify lead--lag relationships between CEX and DEX price movements via correlation analysis.
    \item \textbf{Volume distribution:} compare trading activity across venues for the monitored pairs.
    \item \textbf{Liquidity structure:} compare CEX orderbook depth to DEX pool liquidity and concentrated liquidity structure.
    \item \textbf{Execution costs:} model and measure slippage as a function of trade size for Uniswap pools.
    \item \textbf{Infrastructure development:} build a real-time monitoring pipeline enabling continuous data collection and retrospective analysis.
\end{itemize}

\textbf{Technical scope.} The final system monitors CEX tickers from Coinbase, MEXC, Binance, Gate.io, OKX, Bybit, HTX and KuCoin. On the DEX side, we monitor Uniswap V2 and Uniswap V3 swap events. The DEX collector is designed as a multi-chain listener and is configurable to support additional EVM networks (e.g., Polygon, Arbitrum, Optimism, Base, Avalanche, Fantom, Cronos, zkSync, Polygon zkEVM, Celo) via \texttt{dex-prices/config.json}; however, our empirical analysis focuses on Ethereum and BSC. We analyze BTC/USDT, ETH/USDT and BNB/USDT.

\section{Project Planning}
\subsection{Project Time and Resource Estimation}
\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|p{5cm}|l|}
\hline
\textbf{Phase} & \textbf{Weeks} & \textbf{Deliverables} & \textbf{Status} \\ \hline
Infrastructure Setup & 1--3 & CEX WebSocket consumers, DEX listeners & Complete \\ \hline
Data Pipeline & 4--6 & Price index, storage, stream processing & Complete \\ \hline
Analysis Implementation & 7--9 & Deviation, correlation, slippage modules & Complete \\ \hline
Visualization & 10--11 & Dashboard (Streamlit) & Complete \\ \hline
Documentation & 12 & Final report and system docs & Complete \\ \hline
\end{tabular}
\end{center}
\caption{Project timeline and deliverables}
\end{table}

\subsection{Success Criteria}
\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|l|}
\hline
\textbf{Criterion} & \textbf{Metric} & \textbf{Target} \\ \hline
Data Coverage & CEX sources monitored & $\geq 5$ exchanges \\ \hline
DEX Monitoring & Chains supported & $\geq 2$ (Ethereum, BSC) \\ \hline
Price Index & Update frequency & $\leq 1$ second lag \\ \hline
Historical Data & Analysis period & $\geq 30$ days continuous \\ \hline
Price Deviation & Measurement precision & $\leq 0.01\%$ accuracy \\ \hline
Slippage Model & Prediction accuracy & $R^2 \geq 0.8$ for major pairs \\ \hline
System Uptime & Monitoring availability & $\geq 95\%$ during test period \\ \hline
Sample Size & Trades per pair & $\geq 10{,}000$ DEX trades \\ \hline
\end{tabular}
\end{center}
\caption{Project success criteria and targets}
\end{table}

\subsection{Risk Analysis}
\begin{table}[H]
\begin{center}
\small
\begin{tabular}{|p{3cm}|l|l|p{5cm}|}
\hline
\textbf{Risk} & \textbf{Impact} & \textbf{Likelihood} & \textbf{Mitigation Strategy} \\ \hline
RPC rate limits & High & Medium & Multiple providers, request batching, caching \\ \hline
CEX API downtime & Medium & Medium & Redundant sources, reconnect logic, validation \\ \hline
Data quality issues & Medium & Medium & Outlier detection, cross-venue checks, logging \\ \hline
Blockchain congestion & Medium & Medium & Backfilling, time-window matching for indices \\ \hline
Technical complexity & Medium & High & Modular design, incremental milestones \\ \hline
\end{tabular}
\end{center}
\caption{Risk analysis and mitigation strategies}
\end{table}

\subsection{Team Work (if applicable)}
\textbf{Team structure.} The three-member team divided responsibilities across three primary areas: CEX infrastructure (WebSocket connections, aggregation and price index), DEX infrastructure (on-chain monitoring, event parsing and pool tracking), and analysis/visualization (statistical modules and dashboard). We collaborated through a shared repository, consistent interfaces between modules, and iterative integration to ensure that collected data was usable for downstream analysis.

\chapter{RELATED WORK}
\section{Price Discovery Between CEX and DEX}
Prior work has examined whether price discovery occurs primarily on CEX venues or whether DEX venues contribute meaningfully. Alexander et~al.\ study price discovery and efficiency between Uniswap pools and major centralized exchanges and find that DEXs can contribute to price formation under certain conditions, with behavior varying across pool versions and fee tiers~\cite{alexander2025uniswap}. Wu et~al.\ emphasize that cross-venue latency and market fragmentation create recurring short-lived discrepancies that are resolved by arbitrage activity~\cite{wu2025cex,buterin2014ethereum}.

\section{DEX Market Structure and Liquidity}
DEX market structure differs from CEXs not only in execution mechanism but also in asset coverage and volume concentration. Lehar and Parlour show that DEXs list many more tokens than major CEXs but handle substantially lower volume for established pairs, and that CEX listings often shift volume away from DEX-only trading~\cite{lehar2021dex}. Market reports similarly quantify persistent volume and liquidity gaps between CEX and DEX venues and provide practical depth and liquidity reference metrics~\cite{kaiko2024dex}.

\section{Liquidity and Slippage Analysis}
Execution costs on AMM-based DEXs depend on local liquidity around the current price and increase nonlinearly with trade size. Empirica's framework highlights how concentrated liquidity affects effective depth and slippage, and motivates comparing Uniswap V3 liquidity distribution to an orderbook-like structure~\cite{empirica2024liquidity}. Related analyses note that for major pairs, CEX books often exhibit deeper liquidity at common depth thresholds, while aggregating multiple DEX pools and fee tiers can narrow the gap~\cite{kaiko2024dex,adams2021uniswap}.

\section{MEV and Transaction Costs}
Transaction costs on DEXs include both benign price impact and blockchain-specific frictions. Capponi et~al.\ decompose costs on Uniswap V3 and show that adversarial ordering effects can materially affect realized execution, especially for larger swaps~\cite{capponi2024slippage}. Recent work on CEX--DEX extracted value also highlights increasing centralization in the MEV supply chain (searchers/builders), which can affect who captures cross-venue arbitrage profits and under what conditions~\cite{wu2025cex}.

\section{Existing Tools and Platforms}
Commercial platforms (e.g., Kaiko) offer unified access to depth and market data across venues, while on-chain analytics platforms enable custom DEX queries and capital-flow summaries (e.g., DefiLlama)~\cite{kaiko2024dex,defillama2024tvl}. Open-source tooling demonstrates feasibility of multi-exchange streaming and arbitrage templates, but often targets execution rather than systematic measurement and reporting~\cite{solidquant2024arbitrage}.

\section{Gap in Current Research}
Despite a growing literature on price efficiency and arbitrage, there is limited work that integrates (i) a robust multi-venue CEX reference price, (ii) transaction-level DEX execution monitoring, and (iii) consistent metrics for deviation, lead--lag, and slippage in an end-to-end system suitable for continuous monitoring and reproducible retrospective analysis. Our project targets this gap by combining real-time data collection, database-backed storage, and a modular analysis engine that produces report-ready outputs.

\chapter{METHODOLOGY}
\section{CEX Price Index Calculation}

\textbf{Objective}: derive a robust reference price from multiple CEX sources that represents the consensus market price.

\textbf{Approach}: for each monitored pair, we maintain real-time best bid/ask prices and top-of-book quantities from multiple exchanges via WebSocket connections. At time $t$, we compute the mid-price for exchange $i$ as:
\begin{equation}
\text{mid\_price}_i(t) = \frac{\text{bid}_i(t) + \text{ask}_i(t)}{2}
\end{equation}

We then compute a volume-weighted index:
\begin{equation}
\text{price\_index}(t) = \frac{\sum_{i=1}^{N} \text{mid\_price}_i(t) \times \text{volume}_i}{\sum_{i=1}^{N} \text{volume}_i}
\end{equation}

where $\text{volume}_i$ denotes an exchange weight. In the implementation, weights are adapted using an exponential moving average (EMA) of observed displayed liquidity share, and side-specific VWAPs and total quantities are computed from aggregated bid/ask notionals and quantities.

\section{DEX Trade Monitoring}

\textbf{Objective}: capture DEX trades at transaction level with accurate execution prices.

\textbf{Data source}: we monitor Swap events from Uniswap V2 and Uniswap V3 pools using a configurable multi-chain listener. While the listener supports multiple blockchains through configuration (\texttt{dex-prices/config.json}), the analysis in this report uses Ethereum and BSC, extracting token amounts and timestamps from on-chain logs.

\textbf{Execution price}: for a swap from token0 to token1, execution price is computed from the realized amounts:
\begin{equation}
\text{execution\_price} = \frac{\text{amount1Out}}{\text{amount0In}}
\end{equation}

\section{Price Deviation Measurement}

\textbf{Objective}: quantify deviation between DEX execution prices and the CEX price index.

\textbf{Per-trade deviation}:
\begin{equation}
\text{deviation}_i = \frac{\text{DEX\_price}_i - \text{CEX\_price\_index}_i}{\text{CEX\_price\_index}_i} \times 100\%
\end{equation}

We match each DEX trade to the closest CEX price index value within a small time window around the trade timestamp.

\section{Lead--Lag Correlation Analysis}

\textbf{Objective}: determine the temporal relationship between CEX and DEX price movements.

We compute log return series and evaluate the cross-correlation function across positive and negative lags to identify whether CEX prices lead DEX prices or vice versa~\cite{granger1969causality}.

\section{Slippage Modeling}

\textbf{Objective}: characterize and predict slippage for varying trade sizes.

For Uniswap V2 constant product AMM with reserves $(x, y)$ and input amount $\Delta x$:
\begin{equation}
\Delta y = y - \frac{xy}{x + \Delta x}
\end{equation}
\begin{equation}
\text{slippage}_{\text{theoretical}} = \left|1 - \frac{\Delta y / \Delta x}{y / x}\right|
\end{equation}

We complement theoretical slippage with empirical distributions derived from observed swaps to capture real execution outcomes, including the effects of on-chain congestion and transaction ordering.

\chapter{REQUIREMENTS SPECIFICATION}
This chapter specifies the functional and non-functional requirements for the CMPE492 CEX--DEX market analysis system. Requirements are stated at the system level and mapped to implemented components in Chapter~\ref{chap:implementation}.

\section{Functional Requirements}

\textbf{FR1: CEX data collection.} The system shall maintain real-time WebSocket connections to multiple CEX APIs and ingest best bid/ask prices and quantities for the monitored pairs. It shall automatically reconnect on disconnections.

\textbf{FR2: Price index calculation.} The system shall compute a multi-exchange reference price per symbol using a volume-weighted mid-price aggregation. The index shall update whenever fresh ticker data arrives.

\textbf{FR3: DEX swap monitoring.} The system shall monitor Uniswap V2 and Uniswap V3 Swap events on Ethereum and BSC, and extract execution amounts, pool address, transaction hash, block number, and timestamps.

\textbf{FR4: Deviation measurement.} For each DEX swap, the system shall match the trade timestamp to the closest CEX price index within a small time window and compute CEX--DEX deviation.

\textbf{FR5: Lead--lag analysis.} The system shall provide a lead--lag analysis module that can compute cross-correlation across configurable lags and run causality tests when appropriate.

\textbf{FR6: Slippage characterization.} The system shall compute theoretical AMM price impact (V2 constant product; V3 concentrated liquidity when available) and build empirical slippage distributions from historical swaps.

\textbf{FR7: Storage and querying.} The system shall store time-series data for the price index, DEX swaps, and derived analytics into a database optimized for time-series queries, supporting both real-time visualization and retrospective analysis.

\textbf{FR8: Visualization.} The system shall provide a dashboard that displays real-time price index values and supports visualization of deviations, lead--lag results, and slippage curves as data becomes available.

\section{Non-Functional Requirements}

\textbf{NFR1: Performance.} The system shall process continuous real-time data streams without falling behind. Database writes should be batched where appropriate and queries should use time-bucketed access patterns.

\textbf{NFR2: Reliability.} Collectors shall tolerate external failures (temporary exchange downtime, RPC instability) through retries, reconnection, and redundancy.

\textbf{NFR3: Extensibility.} Adding a new symbol or exchange should require configuration changes rather than a full redesign. Multi-chain monitoring should be configurable per chain.

\textbf{NFR4: Reproducibility.} The system shall support reproducible analysis by persisting raw observations and providing deterministic analysis scripts for generating results.

\section{Use Cases}
This section summarizes representative end-to-end use cases supported by the system.

\subsection{UC1: Monitor Real-Time Price Deviation}
\textbf{Primary actor}: Research analyst. \textbf{Preconditions}: collectors and database are running.
The user selects a trading pair and time range in the dashboard. The system displays the current CEX price index, the latest DEX execution price, and the current deviation, together with short-horizon aggregates (e.g., 5-minute and 1-hour averages) to contextualize transient spikes.
\textbf{Postconditions}: the user can observe real-time alignment between venues and identify abnormal divergence periods.

\subsection{UC2: Analyze Historical Lead--Lag Relationship}
\textbf{Primary actor}: Research analyst. \textbf{Preconditions}: sufficient historical data is available.
The user selects a pair and a historical window. The system computes a cross-correlation function over returns and reports the lag at which correlation peaks; when enabled, it also reports statistical testing outputs (e.g., Granger causality p-values) to support interpretation.
\textbf{Postconditions}: the user obtains a quantitative estimate of information flow direction and characteristic lag.

\subsection{UC3: Estimate Slippage for a Planned Trade}
\textbf{Primary actor}: DEX trader / bot designer. \textbf{Preconditions}: slippage statistics or models have been generated for the target pool/pair.
The user inputs trade direction and size and selects a pool. The system returns theoretical AMM price impact from current pool state and empirical slippage ranges from historical trades (e.g., P50/P90/P99) for comparable sizes.
\textbf{Postconditions}: the user can estimate execution cost before submitting an on-chain transaction.

\subsection{UC4: Compare CEX vs DEX Liquidity}
\textbf{Primary actor}: Research analyst / liquidity provider. \textbf{Preconditions}: required liquidity data sources are available.
The user selects a pair and compares CEX depth (aggregated across exchanges) against DEX effective liquidity around the current price. Liquidity ratios are summarized at standardized thresholds (e.g., $\pm 0.5\%$, $\pm 1\%$, $\pm 2\%$) to make the comparison comparable across venues and time.
\textbf{Postconditions}: the user can evaluate relative execution quality and capital efficiency across venue types.

\chapter{DESIGN}

\section{Information Structure}
\subsection{Database Schema Overview}

The system stores market data in PostgreSQL with TimescaleDB hypertables for time-series efficiency. The core time-series tables are:
\begin{itemize}
    \item \texttt{price\_index}: aggregated reference price per symbol with metadata such as number of exchanges, side VWAPs, and aggregated bid/ask quantities.
    \item \texttt{dex\_swaps}: decoded on-chain swaps with execution price and trade metadata.
    \item \texttt{dex\_pool\_state}: pool state snapshots (e.g., Uniswap V3 tick, sqrtPriceX96, liquidity) captured as historical time-series.
    \item \texttt{price\_deviations}: deviation measurements between DEX execution price and CEX reference price.
    \item \texttt{slippage\_analysis}, \texttt{correlation\_analysis}: derived analytics tables used by the analysis engine.
\end{itemize}

Metadata tables store token and pool information:
\begin{itemize}
    \item \texttt{tokens}: token addresses, symbols, decimals, chain.
    \item \texttt{pools}: pool address, chain, DEX identifier, token0/token1, fee tier.
\end{itemize}

\textbf{Derived views and aggregates.} For convenience and performance, the database includes a \texttt{dex\_trades} view that normalizes swaps into a buy/sell trade format and a continuous aggregate (\texttt{dex\_volume\_1h}) for hourly swap volume rollups.
\subsection{Entity-Relationship Diagram}
The ER diagram describes relationships between pools, tokens, swaps and derived analytics.

\section{Information Flow}
\subsection{Real-Time Data Flow}

The system runs two primary real-time ingestion streams in parallel:
\begin{itemize}
    \item \textbf{CEX stream:} WebSocket tickers from multiple exchanges are aggregated into a per-symbol price index and stored for downstream matching.
    \item \textbf{DEX stream:} Swap events are captured from EVM nodes and persisted with execution price information and metadata.
\end{itemize}

Deviation calculation and analysis jobs operate on the persisted time-series to generate results for visualization and reporting.

\subsection{Activity Diagram: Real-Time Price Deviation Monitoring}
The CEX stream continuously ingests best bid/ask updates from multiple venues and updates the reference price index whenever fresh data arrives. The DEX stream ingests on-chain Swap events as new blocks are produced and computes an execution price per trade. For each swap, the system queries the nearest contemporaneous CEX price index value in a narrow time window around the trade timestamp, computes deviation, persists both raw and derived records, and updates aggregate statistics used by the dashboard.

\subsection{Sequence Diagram: Price Index Calculation}
For a given symbol, the price index module collects per-exchange ticker snapshots, filters stale or anomalous inputs, and computes a volume-weighted reference price using mid-prices. The computed index value is persisted to the database with metadata (e.g., number of contributing venues) and optionally published for real-time visualization.

\subsection{Sequence Diagram: DEX Trade Processing}
When a swap is observed on-chain, the listener parses event fields, normalizes token amounts, and computes execution price. The system then matches the trade time to the closest CEX index observation, computes deviation, and stores the resulting record. Downstream analysis modules consume these stored observations to compute distributions, correlations, and slippage summaries.

\section{System Design}
\subsection{Component Architecture}

The system is structured as modular components:
\begin{itemize}
    \item \textbf{CEX Collector} (\texttt{price-index/}, Go): maintains multiple WebSocket connections and computes the multi-exchange price index.
    \item \textbf{DEX Collector} (\texttt{dex-prices/}, Go): subscribes to new blocks and parses Uniswap V2/V3 swap logs on Ethereum and BSC.
    \item \textbf{Database Layer} (\texttt{database/}): PostgreSQL + TimescaleDB schema and helper clients.
    \item \textbf{Analysis Engine} (\texttt{analysis/}, Python): correlation/lead--lag, deviation statistics, slippage analysis, and report data generation.
    \item \textbf{Dashboard} (\texttt{price-index/dashboard.py}, Streamlit): visualization of real-time and historical metrics.
\end{itemize}

\subsection{Interfaces and Data Contracts}

All components communicate through the database schema (and optionally a shared-memory buffer for live dashboard display). This enables independent operation and simplifies recovery: collectors can restart without breaking analysis jobs as long as data is persisted.

\section{User Interface Design (if applicable)}
The system provides a Streamlit dashboard for monitoring the price index and inspecting analysis outputs interactively.

\subsection{Dashboard Layout}
The dashboard header includes trading pair selection, time range selection, and network/protocol filters where applicable. The main area is organized into tabs: (i) real-time monitoring (index vs latest DEX trade and deviation), (ii) lead--lag analysis (CCF plot and summary statistics), (iii) liquidity comparison (depth/liquidity views and ratios), (iv) slippage analysis (slippage curves and percentiles), and (v) volume analysis (time-series and distribution plots).

\subsection{Interaction Patterns}
Charts support hover tooltips for exact values and timestamps, zooming/drag selection for focusing on sub-periods, and export of plots/data (e.g., CSV, PNG) for reporting. Auto-refresh can be enabled for real-time monitoring while keeping historical analysis views stable.

\subsection{Visual Design Principles}
Visual encoding is kept consistent across views: CEX series use one primary color, DEX series use another, and deviations are highlighted to emphasize divergence periods. Numerical displays use aligned formatting for readability, and secondary controls are grouped to reduce clutter.

\chapter{IMPLEMENTATION AND TESTING}
\label{chap:implementation}
\section{Implementation}
\subsection{CEX Collector (Go)}

The CEX data collector is implemented in \texttt{price-index/}. It maintains concurrent WebSocket connections to multiple exchanges, continuously updates an in-memory shared-memory layout for live visualization, and computes a per-symbol reference price index. The index values are persisted to TimescaleDB at a configurable interval. The collector targets exchanges including Coinbase, MEXC, Binance, Gate.io, OKX, Bybit, HTX and KuCoin.

\subsection{DEX Collector (Go)}

The DEX listener is implemented in \texttt{dex-prices/}. It connects to EVM chains using RPC endpoints, subscribes to new blocks and swap logs, and parses Uniswap V2 and Uniswap V3 Swap events. Supported chains are configured in \texttt{dex-prices/config.json}; multiple networks are available, and the analysis in this report uses Ethereum and BSC. The listener persists swap events to \texttt{dex\_swaps}, upserts token and pool metadata, and records pool state snapshots to \texttt{dex\_pool\_state} for historical analysis. Token and pool metadata are cached to reduce repetitive on-chain calls.

\subsection{Database (PostgreSQL + TimescaleDB)}

The database schema is located in \texttt{database/}. TimescaleDB hypertables store tick-level observations efficiently and enable time-window queries. Adminer provides a lightweight web interface for inspecting tables during development.

\subsection{Analysis Engine (Python)}

The analysis modules in \texttt{analysis/} provide statistical computation over stored data, including price deviation analysis (\texttt{analysis/deviation\_calculator.py}), lead--lag correlation (\texttt{analysis/correlation.py}), slippage analysis (\texttt{analysis/slippage.py}), and volume analysis (\texttt{analysis/volume\_analysis.py}). The script \texttt{analysis/run\_analysis.py} orchestrates end-to-end runs and stores outputs in \texttt{price\_deviations}, \texttt{correlation\_analysis}, and \texttt{slippage\_analysis}.

\section{Testing}
\subsection{Data Validation and Sanity Checks}

Testing focuses on verifying correctness of ingestion and analytics:
\begin{itemize}
    \item \textbf{Connectivity tests:} WebSocket and RPC connectivity, reconnection logic.
    \item \textbf{Schema tests:} database schema validation using \texttt{database/test\_schema.py}.
    \item \textbf{Data sanity:} range checks for prices and volumes, timestamp recency, and cross-venue consistency checks.
\end{itemize}

\section{Deployment}
The system runs locally in development and can be deployed to a server for continuous collection. The database runs via Docker Compose, while collectors and analysis jobs run as long-lived processes or scheduled jobs. The appendix includes operational notes and deployment details.

\chapter{RESULTS}
\section{Overview}
This chapter presents results on CEX--DEX price deviations, lead--lag relationships, and slippage behavior for BTC/USDT, ETH/USDT and BNB/USDT across Ethereum and BSC.

\section{Dataset Summary}
This section summarizes the collection period, number of CEX ticker updates, number of DEX swaps captured, exchange and chain coverage, and any missing-data intervals. Although the DEX listener supports additional networks via configuration, the reported dataset covers Ethereum and BSC.

\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|}
\hline
\textbf{Item} & \textbf{Value (TBD)} \\ \hline
Collection period & TBD \\ \hline
Symbols & BTC/USDT, ETH/USDT, BNB/USDT \\ \hline
CEX exchanges & Coinbase, MEXC, Binance, Gate.io, OKX, Bybit, HTX, KuCoin \\ \hline
DEX protocols & Uniswap V2, Uniswap V3 \\ \hline
Chains & Ethereum, BSC \\ \hline
\#CEX ticker records & TBD \\ \hline
\#DEX swaps & TBD \\ \hline
\hline
\end{tabular}
\end{center}
\caption{Dataset summary (placeholder)}
\end{table}

\section{CEX--DEX Price Deviation}
We report deviation distributions (mean, standard deviation, MAD, and percentiles) per symbol, separated by chain and protocol where applicable. We also include time-series plots highlighting periods of persistent deviation and major outliers.

\begin{figure}[h]
\centering
\fbox{\parbox{0.9\linewidth}{\centering Placeholder: deviation time-series plot (CEX price index vs. DEX execution price and deviation \%).}}
\caption{CEX--DEX deviation over time (placeholder)}
\end{figure}

\section{Lead--Lag Analysis}
We present cross-correlation function (CCF) plots and the lag value at which correlation peaks, indicating whether CEX prices lead DEX prices and by how much. Statistical testing results (e.g., Granger causality) are also reported where applicable.

\begin{figure}[h]
\centering
\fbox{\parbox{0.9\linewidth}{\centering Placeholder: lead--lag cross-correlation plot (CCF) per symbol.}}
\caption{Lead--lag cross-correlation between CEX and DEX returns (placeholder)}
\end{figure}

\section{Slippage and Execution Cost}
We report empirical slippage distributions by trade size bin and compare them with theoretical AMM price impact estimates. Results are summarized with slippage curves (median and tail percentiles).

\begin{figure}[h]
\centering
\fbox{\parbox{0.9\linewidth}{\centering Placeholder: slippage vs trade size curve (P50/P90/P99).}}
\caption{Slippage as a function of trade size (placeholder)}
\end{figure}

\section{Liquidity Comparison}
We compare CEX depth at $\pm0.5\%$, $\pm1\%$, and $\pm2\%$ to the effective DEX liquidity around the current price, and report liquidity ratios per symbol.

\section{Dashboard Snapshot}
We include dashboard screenshots and describe the interaction flow (pair selection, time-range selection, and displayed metrics).

\chapter{CONCLUSION}
This report presented an end-to-end system for monitoring and analyzing market microstructure differences between centralized and decentralized cryptocurrency exchanges. By combining a multi-exchange CEX price index with on-chain Uniswap V2/V3 trade monitoring across Ethereum and BSC, we enable consistent measurement of price deviations, lead--lag effects, and execution costs for BTC/USDT, ETH/USDT and BNB/USDT.

As final plots and tables are incorporated, the report will quantify how closely DEX execution tracks the CEX reference price, how lead--lag behavior varies across market conditions, and how slippage scales with trade size under real-world conditions.

\section{Limitations and Future Work}
Key limitations include external dependency reliability (exchange APIs and RPC endpoints), incomplete coverage of on-chain transaction ordering effects, and the need for longer continuous datasets for stronger statistical significance. Future work includes improved MEV classification, broader DEX coverage, deeper liquidity measurement (CEX orderbook snapshots and Uniswap V3 liquidity distribution), and more robust model validation across regimes.

\bibliographystyle{plain}
\bibliography{references}

\appendix	
\chapter{SAMPLE APPENDIX}
Contents of the appendix.

\end{document}